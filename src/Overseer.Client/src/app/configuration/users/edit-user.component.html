<mat-card class="form-card">
  <mat-card-header>
    <div mat-card-avatar>
      <mat-icon class="edit">edit</mat-icon>
      <mat-icon class="user">person</mat-icon>
    </div>
    <mat-card-title> {{ 'editingUser' | i18next }} '{{ user?.username }}' </mat-card-title>
  </mat-card-header>
  <mat-card-content>
    <h5>{{ 'changePassword' | i18next }}</h5>
    <form [formGroup]="passwordForm">
      <mat-form-field>
        <mat-label>{{ 'password' | i18next }}</mat-label>
        <input matInput type="password" id="password" formControlName="password" autocomplete="new-password" />
      </mat-form-field>

      <mat-form-field>
        <mat-label>{{ 'confirmPassword' | i18next }}</mat-label>
        <input matInput type="password" id="passwordMatch" formControlName="confirmPassword" autocomplete="new-password" />
      </mat-form-field>
      <div class="form-actions">
        <span class="spacer"></span>
        <button color="primary" mat-button (click)="changePassword()" [disabled]="passwordForm.pristine || form.invalid">
          {{ 'changePassword' | i18next }}
        </button>
      </div>
    </form>
    <h5>{{ 'userSettings' | i18next }}</h5>
    <form [formGroup]="form">
      <mat-form-field>
        <mat-label>{{ 'accessLevel' | i18next }}</mat-label>
        <mat-select id="accessLevel" formControlName="accessLevel">
          <mat-option *ngFor="let level of accessLevels" [value]="level.value">
            {{ level.translationKey | i18next }}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <mat-form-field>
        <mat-label>{{ 'sessionLifetime' | i18next }}</mat-label>
        <mat-select id="sessionLifetime" formControlName="sessionLifetime">
          <mat-option *ngFor="let lifetime of lifetimes" [value]="lifetime.value">
            {{ lifetime.value }} {{ lifetime.translationKey | i18next }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </form>
    <div *ngIf="displayPreauthentication">
      <mat-form-field matTooltip="{{ 'preauthenticationDescription' | i18next }}">
        <mat-label>{{ 'preauthenticationTitle' | i18next }}</mat-label>
        <input #generatedUrlInput matInput type="text" readonly value="{{ generatedUrl }}" />
        <button *ngIf="!generatedUrl" matSuffix mat-icon-button (click)="generatePreAuthentication()">
          <mat-icon matTooltip="{{ 'generate' | i18next }}">cached</mat-icon>
        </button>
        <button *ngIf="generatedUrl" matSuffix mat-icon-button (click)="copyToClipboard(generatedUrlInput)">
          <mat-icon matTooltip="{{ 'copy' | i18next }}">content_copy</mat-icon>
        </button>
      </mat-form-field>
    </div>
  </mat-card-content>
  <mat-card-actions>
    <button mat-button color="warn" (click)="delete()">
      {{ 'delete' | i18next }}
    </button>
    <button mat-button (click)="signOut()" [disabled]="!user?.isLoggedIn">
      {{ 'logout' | i18next }}
    </button>
    <span class="spacer"></span>
    <a mat-button routerLink="/configuration/users">{{ 'cancel' | i18next }}</a>
    <button color="primary" mat-button (click)="save()" [disabled]="form.pristine || form.invalid">
      {{ 'save' | i18next }}
    </button>
  </mat-card-actions>
</mat-card>
